#include <stdio.h>
#include <stdlib.h>


double *ElementalHartreePotentialMatrix(int order,double *vij)
{
	int P = order + 1;

	double *eMatHV = (double *)malloc(sizeof(double)*(P*P));

	switch(order)
	{
		case 1:
			
			eMatHV[0] = (3.0*vij[0] + vij[1])/6.0; eMatHV[1] = (vij[0]+vij[1])/6.0;
		       	eMatHV[2] = eMatHV[1];  eMatHV[3] = (vij[0] + vij[1]*3.0)/6.0;
			break;
		case 2:
	
			eMatHV[0] = (1.0/210.0)*(39.0*vij[0] + 20.0*vij[1] - 3.0*vij[2]);
			eMatHV[1] = (2.0/105.0)*( 5.0*vij[0] +  4.0*vij[1] - 2.0*vij[2]);

			eMatHV[2] = (1.0/210.0)*(-3.0*vij[0] -  8.0*vij[1] - 3.0*vij[2]);
		      	eMatHV[3] = eMatHV[1];
			eMatHV[4] = (8.0/105.0)*(vij[0] + 12.0*vij[1] + vij[2]);
			eMatHV[5] = (-2.0/105.0)*(2.0*vij[0] - 4.0*vij[1] - 5.0*vij[2]);
		     	eMatHV[6] = eMatHV[2];
			eMatHV[7] = eMatHV[5];
			eMatHV[8] = (1./210.0)*(-3.0*vij[0] + 20.0*vij[1] + 39.0*vij[2]);
			break;
		case 3:

			eMatHV[0]  = (357.*vij[0] + 216.*vij[1] - 81.*vij[2] + 20.*vij[3])/3360.;
	       		eMatHV[1]  = (3./560.)*(12.*vij[0] + 18.*vij[1] - 9.*vij[2] + vij[3]);
			eMatHV[2]  = -3.*( 9.*vij[0] + 18.*vij[1] - 9.*vij[2] - 2.*vij[3])/1120.;
	       		eMatHV[3]  = (10.*vij[0] + 9.*vij[1] + 9.*vij[2] + 10.*vij[3])/1680.;
			eMatHV[4]  = eMatHV[1];
	       		eMatHV[5]  = (27./1120.)*(4.*vij[0] + 27.*vij[1] + vij[3]);
		       	eMatHV[6]  = -(27./560.)*(vij[0] + vij[3]);
		    	eMatHV[7]  =  (3./1120.)*(2.*vij[0] + 9.*vij[1] - 18.*vij[2] - 9.*vij[3]);
	       		eMatHV[8]  = eMatHV[2];
		       	eMatHV[9]  = eMatHV[6];
	       		eMatHV[10] = (27./1120.)*(vij[0] + 27.*vij[2] + 4.*vij[3]);
		      	eMatHV[11] = (3./560.)*(vij[0] - 9.*vij[1] + 18.*vij[2] + 12.*vij[3]);
	       		eMatHV[12] = eMatHV[3];
		       	eMatHV[13] = eMatHV[7];
	       		eMatHV[14] = eMatHV[11];
			eMatHV[15] = (20.*vij[0] - 81.*vij[1] + 216.*vij[2] + 357.*vij[3])/3360.;

			break;
		case 4:

			eMatHV[0]  =  0.071734438401105067772*vij[0] + 0.051365918032584699251*vij[1] - 0.031706565039898373232*vij[2] +
		    		0.013912013912013912014*vij[3] - 0.0023075689742356409023*vij[4];
		      	eMatHV[1]  =  0.051365918032584699251*vij[0] + 0.093141426474759808093*vij[1] - 0.054542987876321209655*vij[2] +
			       	0.019259752593085926419*vij[3] - 0.0048149381482714816048*vij[4];
		      	eMatHV[2]  = -0.031706565039898373232*vij[0] - 0.054542987876321209655*vij[1] + 0.024094424094424094424*vij[2] -
		    		0.0032362699029365696032*vij[3] + 0.0040157373490706824040*vij[4];
		      	eMatHV[3]  =  0.013912013912013912014*vij[0] + 0.019259752593085926419*vij[1] - 0.0032362699029365696032*vij[2] -
			     	0.0053674720341387008054*vij[3] - 0.0048149381482714816048*vij[4];
		      	eMatHV[4]  = -0.0023075689742356409023*vij[0] - 0.0048149381482714816048*vij[1] + 0.0040157373490706824040*vij[2] -
			       	0.0048149381482714816048*vij[3] - 0.0023075689742356409023*vij[4];
		      	eMatHV[5]  =  0.051365918032584699251*vij[0] + 0.093141426474759808093*vij[1] - 0.054542987876321209655*vij[2] +
			       	0.019259752593085926419*vij[3] - 0.0048149381482714816048*vij[4];
		      	eMatHV[6]  =  0.093141426474759808093*vij[0] + 0.59610512943846277180*vij[1] - 0.12250465583798917132*vij[2] +
			      	0.070724337391004057671*vij[3] - 0.0053674720341387008054*vij[4];
		      	eMatHV[7]  = -0.054542987876321209655*vij[0] - 0.12250465583798917132*vij[1] + 0.13450253450253450253*vij[2] -
			      	0.089668356335023001690*vij[3] - 0.0032362699029365696032*vij[4];
		      	eMatHV[8]  =  0.019259752593085926419*vij[0] + 0.070724337391004057671*vij[1] - 0.089668356335023001690*vij[2] +
			      	0.070724337391004057671*vij[3] + 0.019259752593085926419*vij[4];
		      	eMatHV[9]  = -0.0048149381482714816048*vij[0] - 0.0053674720341387008054*vij[1] - 0.0032362699029365696032*vij[2] +
			     	0.019259752593085926419*vij[3] + 0.013912013912013912014*vij[4];
		      	eMatHV[10] = -0.031706565039898373232*vij[0] - 0.054542987876321209655*vij[1] + 0.024094424094424094424*vij[2] -
			    	0.0032362699029365696032*vij[3] + 0.0040157373490706824040*vij[4];
		      	eMatHV[11] = -0.054542987876321209655*vij[0] - 0.12250465583798917132*vij[1] + 0.13450253450253450253*vij[2] -
			   	0.089668356335023001690*vij[3] - 0.0032362699029365696032*vij[4];
		      	eMatHV[12] =  0.024094424094424094424*vij[0] + 0.13450253450253450253*vij[1] + 0.34312354312354312354*vij[2] +
			  	0.13450253450253450253*vij[3] + 0.024094424094424094424*vij[4];
		      	eMatHV[13] = -0.0032362699029365696032*vij[0] - 0.089668356335023001690*vij[1] + 0.13450253450253450253*vij[2] -
			    	0.12250465583798917132*vij[3] - 0.054542987876321209655*vij[4];
		      	eMatHV[14] =  0.0040157373490706824040*vij[0] - 0.0032362699029365696032*vij[1] + 0.024094424094424094424*vij[2] -
			      	0.054542987876321209655*vij[3] - 0.031706565039898373232*vij[4];
		       	eMatHV[15] =  0.013912013912013912014*vij[0] + 0.019259752593085926419*vij[1] - 0.0032362699029365696032*vij[2] -
				0.0053674720341387008054*vij[3] - 0.0048149381482714816048*vij[4];
		      	eMatHV[16] =  0.019259752593085926419*vij[0] + 0.070724337391004057671*vij[1] - 0.089668356335023001690*vij[2] +
			     	0.070724337391004057671*vij[3] + 0.019259752593085926419*vij[4];
		      	eMatHV[17] = -0.0032362699029365696032*vij[0] - 0.089668356335023001690*vij[1] + 0.13450253450253450253*vij[2] -
			 	0.12250465583798917132*vij[3] - 0.054542987876321209655*vij[4];
		      	eMatHV[18] = -0.0053674720341387008054*vij[0] + 0.070724337391004057671*vij[1] - 0.12250465583798917132*vij[2] +
			       	0.59610512943846277180*vij[3] + 0.093141426474759808093*vij[4];
		      	eMatHV[19] = -0.0048149381482714816048*vij[0] + 0.019259752593085926419*vij[1] - 0.054542987876321209655*vij[2] +
			      	0.093141426474759808093*vij[3] + 0.051365918032584699251*vij[4];
		      	eMatHV[20] = -0.0023075689742356409023*vij[0] - 0.0048149381482714816048*vij[1] + 0.0040157373490706824040*vij[2] -
			    	0.0048149381482714816048*vij[3] - 0.0023075689742356409023*vij[4];
		      	eMatHV[21] = -0.0048149381482714816048*vij[0] - 0.0053674720341387008054*vij[1] - 0.0032362699029365696032*vij[2] +
			    	0.019259752593085926419*vij[3] + 0.013912013912013912014*vij[4];
		      	eMatHV[22] =  0.0040157373490706824040*vij[0] - 0.0032362699029365696032*vij[1] + 0.024094424094424094424*vij[2] -
			    	0.054542987876321209655*vij[3] - 0.031706565039898373232*vij[4];
		      	eMatHV[23] = -0.0048149381482714816048*vij[0] + 0.019259752593085926419*vij[1] - 0.054542987876321209655*vij[2] +
			    	0.093141426474759808093*vij[3] + 0.051365918032584699251*vij[4];
		      	eMatHV[24] = -0.0023075689742356409023*vij[0] + 0.013912013912013912014*vij[1] - 0.031706565039898373232*vij[2] +
			      	0.051365918032584699251*vij[3] + 0.071734438401105067772*vij[4];
			break;
	}

	return eMatHV;
}
